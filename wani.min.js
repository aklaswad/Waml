!function(){"use strict";function a(){return i?i:i=new AudioContext}function b(a,b,c){return"undefined"==typeof b&&(b=440),"undefined"==typeof c&&(c=69),b*Math.pow(2,(a-c)/12)}function c(a,b,c){return"undefined"==typeof b&&(b=440),"undefined"==typeof c&&(c=69),12*Math.log2(a/b)+c}function d(a){var b=j.getAudioContext();"undefined"==typeof a&&(a=1);var c=b.createOscillator(),d=b.createWaveShaper(),e=b.createGain();return d.curve=new Float32Array([1,1]),e.gain.value=a,c.connect(d),d.connect(e),c.start(),e}function e(a,b,c){var e=a.createGain(),f=d(1);return Object.defineProperty(e,"value",{set:function(a){if("function"==typeof e.onchange){var b=e.onchange(a,e.__wani_value);if(!1===b)return}e.__wani_value=a,f.gain.value=a},get:function(){return e.__wani_value}}),e.setValueAtTime=function(){AudioParam.prototype.setValueAtTime.apply(f.gain,arguments)},e.linearRampToValueAtTime=function(){AudioParam.prototype.linearRampToValueAtTime.apply(f.gain,arguments)},e.exponentialRampToValueAtTime=function(){AudioParam.prototype.exponentialRampToValueAtTime.apply(f.gain,arguments)},e.setTargetAtTime=function(){AudioParam.prototype.setTargetAtTime.apply(f.gain,arguments)},e.setValueCurveAtTime=function(){AudioParam.prototype.setValueCurveAtTime.apply(f.gain,arguments)},e.cancelScheduledValues=function(){AudioParam.prototype.cancelScheduledValues.apply(f.gain,arguments)},e.gain.value=1,e.onchange=c,f.connect(e),e}function f(a,c,d,e,f,g){var h;"undefined"==typeof c&&(c=0),"undefined"==typeof d&&(d=128),e||(e=256);for(var i=Math.abs(c-d),j=new Float32Array(e),k=0;e>k;k++)j[k]=b(c+i*(k/e),f,g);return h=a.createWaveShaper(),h.curve=j,h}function g(a,b,c,d,e,g){var h=a.createGain(),i=f(a,b,c,d,e,g);return h.gain.value=1/Math.abs(b-c),h.connect(i),h.connect=function(){i.connect.apply(i,arguments)},h.disconnect=function(){i.disconnect.apply(i,arguments)},h}function h(a){this.ctx=a}var i;h.prototype.connect=function(){return this.output.connect.apply(this.output,arguments)},h.prototype.disconnect=function(){return this.output.disconnect.apply(this.output,arguments)};var j={getAudioContext:a,Module:h,modules:{},registerModule:function(a){return this.__validate(a)?(this.modules[a.name]=a,void("undefined"!=typeof this.onmoduleload&&this.onmoduleload(a))):void this.console.error("Failed to load module")},__validate:function(a){var b;return a.name?(b=a.name,a.isSynth||a.isEffect?!0:(this.console.error("Module must be synth or effect"),!1)):(this.console.error("Cannot register unnamed module"),!1)},createModule:function(a){var b=this.modules[a];if(!b)throw"Module '"+a+"' is not found";return new b.create(this.getAudioContext())},listSynthesizers:function(){var a,b=[];for(a in this.modules)this.modules[a].isSynth&&b.push(a);return b},listEffects:function(){var a,b=[];for(a in this.modules)this.modules[a].isEffect&&b.push(a);return b},describeAll:function(a){for(var b in this.modules)this.describe(b,a)},describe:function(a,b){"undefined"===b&&(b=console.log);var c=this.modules[a];return c?(b("Name: "+a),void b("Author: "+c.author||"(unknown)")):void b("Module "+a+" is not registered")},definition:function(a){return this.modules[a]},console:console,createDCOffset:d,createAudioParam:e,createMtofTilde:g,midi2freq:b,freq2midi:c,siglog:function(a,b){var c=0,d=a.createScriptProcessor(8192,1,1);b||(b="siglog"),d.onaudioprocess=function(a){if(!(c++%4)){var d=a.inputBuffer.getChannelData(0);console.log(b+":",d[0])}};var e=a.createGain();return e.gain.value=0,d.connect(e),e.connect(a.destination),d}};window.Wani=j}(),function(){function a(a,b){var c=Wani.getAudioContext(),d=c.createScriptProcessor(2048,1,1),e=document.getElementById(a),f=e.width,g=e.height,h=e.getContext("2d"),i=b.mutiplier||1;h.fillStyle=b.backgroundColor||"#fff",h.lineWidth="1px";var j=0,k={max:0,maxframe:0};d.onaudioprocess=function(a){var c,d=a.inputBuffer.getChannelData(0);h.clearRect(0,0,f,g),h.fillRect(0,0,f,g),b.centerLine&&(h.strokeStyle=b.centerLine,h.beginPath(),h.moveTo(0,g/2),h.lineTo(f-1,g/2),h.stroke()),h.strokeStyle=b.waveColor||"#000",h.moveTo(0,g/2),h.beginPath();var e=0;for(c=0;f>c;c++){var l=[],m=4*c;l[0]=i*d[m],l[1]=i*d[m+1],l[2]=i*d[m+2],l[3]=i*d[m+3];var n,o=1,p=-1,q=0;for(n=1;4>n;n++)p<l[n]&&(p=l[n]),l[n]<o&&(o=l[n]),q<Math.abs(l[n])&&(q=Math.abs(l[n]));h.lineTo(c,g/2+-g/2*o),h.lineTo(c,g/2+-g/2*p),e=q}(k.max<e||k.maxframe<j-8)&&(k.max=e,k.maxframe=j),h.stroke(),j++};var l=c.createGain();return l.gain.value=0,l.connect(c.destination),d.connect(l),d}function b(a,b){var c=document.createElement("script");c.src=a,b&&(c.onload=b),document.body.appendChild(c)}Wani.Web={createWaveFormRenderer:a,loadScriptFromURL:b}}();